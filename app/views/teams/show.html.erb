<div class="main-content">
  <h1><%= @team.name %> の詳細</h1>
  <p><strong>リーダー: <%= @team.owner.name %></strong></p>

  <div>
    <h5>チームメンバーを招待する</h5>
    <%# <p>チームリーダーだけが行えます。<> %>
    <%= form_with model: :assign, scope: :post, url: team_assigns_path(@team), local: true do |form| %>
      <div class="input-group input-group-sm">
        <%= text_field_tag :email, '', { class: 'form-control', placeholder: "招待したい方のメールアドレスを入力してください" } %>
        <span class="input-group-append">
          <button type="submit" class="btn btn-info btn-flat">招待</button>
        </span>
      </div>
    <% end %>
  </div>


<div class="btn-cover">
  <div class="user-show">
    <table class="team-table">
          <h3>チームメンバー</h3>
      <thead>
        <tr>
          <th>名前</th>
        </tr>
      </thead>
      <tbody>
          <% @members.each do |member| %>
            <tr>
              <td><%= member.name %></td>
            </tr>
          <% end %>
      </tbody>
    </table>
    </div>
  </div>

<div class="btn-cover">
  <div class="user-show">
    <table class="team-table">
      <thead>
        <tr>
          <th></th>
          <th>チーム名</th>
          <th>課題題目</th>
          <th>期限日</th>
          <th>優先度</th>
          <th>進捗</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @issues.each do |issue| %>
          <tr>
            <% if issue.done_flag == true %>
              <td> 完了 </td>
            <% else %>
              <td>未完了</td>
            <% end %>
              <td><%= issue.team.name %></td>
              <td><%= issue.title %></td>
              <td><%= issue.due_date_at %></td>
              <td><%= issue.priority %></td>
              <td><%= issue.status %></td>
              <td><%= link_to '詳細', team_issue_path(issue.id, team_id: issue.team.id) %></td>
              <td><%= link_to '編集', edit_team_issue_path(issue.id, team_id: issue.team.id) %></td>
              <td><%= link_to '削除', team_issue_path(issue.id, team_id: issue.team.id), method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

    <table>
      <thead>
        <tr>
          <th> 担当者ごとのアクション数</th>
        </tr>
      </thead>
        <tbody>
          <tr>
            <td><%= column_chart @data, id: "column-chart", width: "200px", height: "200px"%></td>
          </tr>
        </tbody>
    </table>


<% if @assign.present? %>
  <%= link_to 'チームから外れる', team_assign_path(id: @assign.id, team_id: @assign.team_id), method: :delete, class: 'btn btn-danger' %>
<% else %>
<% end %>

<% if current_user.id == @team.owner_id %>
  <%= link_to 'チームを編集する', edit_team_path(@team) %>
<% end %>
<%= link_to 'チーム一覧', teams_path %>
<%= link_to '課題一覧', team_issues_path(@team, @issue) %>
